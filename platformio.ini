[env:xiao_esp32s3_can_modbus]
platform = espressif32
board = seeed_xiao_esp32s3
framework = arduino

; === SERIAL CONFIGURATION ===
monitor_speed = 115200
monitor_filters = esp32_exception_decoder
monitor_port = auto

; KLUCZOWE: Automatyczny restart ESP32 przy połączeniu monitora
monitor_rts = 0
monitor_dtr = 1
monitor_eol = LF
monitor_echo = true

; === BUILD FLAGS ===
build_flags = 
    -DBOARD_HAS_PSRAM
    -DARDUINO_USB_MODE=1
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DMQTT_MAX_PACKET_SIZE=1024
    -DCORE_DEBUG_LEVEL=4

; === DEPENDENCIES ===
lib_deps = 
    knolleary/PubSubClient@^2.8
    mathieucarbou/ESP Async WebServer@^3.0.6
    AsyncTCP@^1.1.1
    limengdu/Arduino_CAN_BUS_MCP2515@^1.0.1


; === UPLOAD CONFIGURATION ===
upload_speed = 460800
upload_port = auto
upload_resetmethod = esp32r0

; === BOARD SPECIFIC ===
board_build.flash_mode = qio
board_build.f_cpu = 240000000L